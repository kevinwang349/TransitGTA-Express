<!DOCTYPE html>
<html lang="en">
    <head>
        <title><%= title %></title>
    </head>
    <body>
        <a href="https://transitGTA.onrender.com" style="font-size: 20px; color: #ff0000">Home</a>

        <p><%= title %></p>
        <div style="width: 90%; height: 570px; margin: auto; overflow: scroll; border: 2px black solid" id="outerBox" onscroll="updateDisplay()">
            <table>
                <tr style="position: relative; background: white; z-index: 2; top: 0px;" id="stopsRow">
                    <td></td>
                    <% for(let i=0;i<stopnames.length;i++){ %>
                        <td style="border-bottom: 1px black solid; border-right: 1px black solid; font-size: 14px" class="link">
                            <a href="./stopschedule?s=<%= schedule[0][i]%>&t=<%= dateStr%>"><%= stopnames[i]%></a>
                        </td>
                    <%}%>
                </tr>
                <% for(let i=1;i<schedule.length;i++){ %>
                    <tr>
                        <td style="white-space: nowrap; border-bottom: 1px black solid; border-right: 1px black solid; font-size: 14px; position: relative; z-index: 1; background-color: #<%= routecolor %>" class="link trip">
                            <a href="./trip?t=<%= tripids[i]%>"><%= headsigns[i]%></a>
                        </td>
                        <% for(let j=0;j<schedule[i].length;j++){ %>
                            <td style="border-top: 1px black solid; border-left: 1px black solid; position: relative; z-index: 0; background-color: #<%= colors[i][j]%>"><%= schedule[i][j]%></td>
                        <%}%>
                    </tr>
                <%}%>
            </table>
        </div>
        <a href="./routevehicles?r=<%= routeshortname %>">Route Vehicles for this route</a> <br>
        <a href="./routeschedule?r=<%= routeshortname %>&d=<%= reverseDir %>&t=<%= dateStr %>">Route schedule in the opposite direction</a>

        <script>
            // Update positions of top row (stops) and left column (trips) to force them to stick to the top / left of the schedule table box
            function updateDisplay(){
                const ypos=document.getElementById("outerBox").scrollTop;
                document.getElementById("stopsRow").style.top=ypos+'px';
                const xpos=document.getElementById("outerBox").scrollLeft;
                const cells=document.getElementsByClassName('trip');
                for(const cell of cells){
                    cell.style.left=xpos+'px';
                }
            }
        </script>
        <br>
    </body>
</html>