<html>

<head>
    <meta charset="UTF-8">
    <title>System Maps</title>
    <%- include("../partials/head") %>
</head>

<body>
    <a href="https://transitGTA.onrender.com" style="font-size: 20px; color: #ff0000">Home</a>

    <p id="load">Loading</p>

    <div id="outerbox">
    </div>

    <script>
        // Loading
        let load=0;
        const loading=document.getElementById('load');
        function updateLoad(){
            if(load<3){
                load++;
                loading.innerHTML+='.';
            }else if(load==3){
                load=0;
                loading.innerHTML='Loading';
            }
        }
        function stopLoading(){
            loading.innerHTML='';
            clearInterval(interval);
        }
        const interval=setInterval(updateLoad, 1000);

        // Splits a CSV string into a 2D array
        function strArray(string) {
            const array1 = string.split('\n');
            let array2 = [];
            for (const el of array1) {
                array2.push(el.split(','));
            }
            return array2;
        }
        // Decodes strings passed from Express server
        function parseHtmlEntities(str) {
            return str.replace(/&#([0-9]{1,3});/gi, function(match, numStr) {
                var num = parseInt(numStr, 10); // read num as normal number
                return String.fromCharCode(num);
            });
        }

        const agency=`<%= agency%>`;
        const routeShapesStr=`<%= routeshapes%>`;
        const shapes=strArray(routeShapesStr);
    </script>
    <script type="text/javascript" src="/trains.js"></script>
</body>

</html>